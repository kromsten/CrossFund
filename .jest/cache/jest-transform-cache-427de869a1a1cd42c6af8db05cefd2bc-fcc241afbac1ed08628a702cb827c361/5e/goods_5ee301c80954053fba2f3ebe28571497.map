{"version":3,"names":["_wait","require","asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","args","arguments","apply","err","undefined","createProposal","cm","contractAddress","title","description","executeContract","JSON","stringify","submit_proposal","exports","fundProposal","proposal_id","amount","denom","auto_agree","fund_proposal","submitApplication","applicants","auditors","deliver_by","submit_application","application","acceptApplication","application_sender","accept_application","approveApplication","approve_application","registerICA","connection_id","verifyApplication","verify_application","queryProposals","queryContract","all_proposals","queryProposalById","proposal","queryCustodyFunds","address","skip_locked","address_funds","queryICA","numAttempts","length","getWithAttempts","blockWaiter","interchain_account_address","_ref","response","_x"],"sources":["goods.ts"],"sourcesContent":["import { CosmosWrapper, WalletWrapper } from \"./cosmos\";\nimport { Addr, AllProposalInfo, CustodyFunds, Expiration, ProposalInfo, ShareHolder } from \"./types\";\nimport { getWithAttempts } from \"./wait\";\n\n\n\nexport const createProposal = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  title?: string,\n  description?: string,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      submit_proposal: {\n        title: title ?? 'test proposal',\n        description:  description ?? 'test proposal description',\n      }\n    }),\n  );\n}\n\nexport const fundProposal = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  amount: string,\n  denom: string,\n  auto_agree?: boolean,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      fund_proposal: {\n        proposal_id,\n        auto_agree,\n      }\n    }),\n    [{ amount, denom }],\n  );\n}\n\n\n\nexport const submitApplication = (\n  cm: WalletWrapper,\n  contractAddress: Addr,\n  proposal_id: number,\n  applicants: ShareHolder[],\n  auditors: ShareHolder[],\n  deliver_by: Expiration\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      submit_application: {\n        proposal_id,\n        application: {\n          applicants,\n          auditors,\n          deliver_by,\n        }\n      }\n    }),\n  );\n}\n\nexport const acceptApplication = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  application_sender: Addr,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      accept_application: {\n        proposal_id,\n        application_sender\n      }\n    }),\n  );\n}\n\n\nexport const approveApplication = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  application_sender: Addr,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      approve_application: {\n        proposal_id,\n        application_sender\n      }\n    }),\n  );\n}\n\nexport const registerICA = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  connection_id: string,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      \"register_i_c_a\": {\n        proposal_id,\n        connection_id\n      }\n    }),\n  );\n}\n\n\n\nexport const verifyApplication = (\n  cm: WalletWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  application_sender: Addr,\n) => {\n  return cm.executeContract(\n    contractAddress,\n    JSON.stringify({\n      verify_application: {\n        proposal_id,\n        application_sender\n      }\n    }),\n  );\n}\n\n\n\nexport const queryProposals = (\n  cm: CosmosWrapper,\n  contractAddress: string,\n) => {\n  return cm.queryContract<AllProposalInfo>(contractAddress, {\n    all_proposals: {}\n  }\n);\n}\n  \n\nexport const queryProposalById = (\n  cm: CosmosWrapper,\n  contractAddress: string,\n  proposal_id: number,\n) =>\n  cm.queryContract<ProposalInfo>(contractAddress, {\n    proposal: { proposal_id }\n  }\n);\n\n\nexport const queryCustodyFunds = (\n  cm: CosmosWrapper,\n  contractAddress: string,\n  address: string,\n  skip_locked?: boolean,\n) => {\n    return cm.queryContract<[string, CustodyFunds][]>(contractAddress, {\n      address_funds: { address, skip_locked }\n    });\n  }\n\n\n\nexport const queryICA = (\n  cm: CosmosWrapper,\n  contractAddress: string,\n  proposal_id: number,\n  connection_id: string,\n  numAttempts = 20,\n) =>\n  getWithAttempts(\n    cm.blockWaiter,\n    () =>\n      cm.queryContract<{\n        interchain_account_address: string;\n      }>(contractAddress, {\n        interchain_account_address: {\n          proposal_id,\n          connection_id,\n        },\n      }),\n    async (response) => response != null,\n    numAttempts,\n  );\n"],"mappings":"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"}